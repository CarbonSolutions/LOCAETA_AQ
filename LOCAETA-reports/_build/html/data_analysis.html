
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Assessment of Amine-based CCS in LA on air quality and public health &#8212; Assessment of Air Quality and Public Health impact by Amine-based CCS tech</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'data_analysis';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to your Jupyter Book" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Assessment of Air Quality and Public Health impact by Amine-based CCS tech</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Assessment of Amine-based CCS in LA on air quality and public health</a></li>

</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/data_analysis.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Assessment of Amine-based CCS in LA on air quality and public health</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Assessment of Amine-based CCS in LA on air quality and public health</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ccs-faciltiy-emissions-analysis">1. CCS Faciltiy emissions analysis</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inmap-simulation-results">2. INMAP simulation results</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="assessment-of-amine-based-ccs-in-la-on-air-quality-and-public-health">
<h1>Assessment of Amine-based CCS in LA on air quality and public health<a class="headerlink" href="#assessment-of-amine-based-ccs-in-la-on-air-quality-and-public-health" title="Link to this heading">#</a></h1>
<p>Authors: Yunha Lee, Qasim Mehdi, Daniel Rodriguez, Kat Sale, Bjorn Brooks, Amy Jordan</p>
<ul class="simple">
<li><p>Contact: <a class="reference external" href="mailto:yunha&#46;lee&#37;&#52;&#48;carbonsolutionsllc&#46;com">yunha<span>&#46;</span>lee<span>&#64;</span>carbonsolutionsllc<span>&#46;</span>com</a></p></li>
</ul>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="ccs-faciltiy-emissions-analysis">
<h1>1. CCS Faciltiy emissions analysis<a class="headerlink" href="#ccs-faciltiy-emissions-analysis" title="Link to this heading">#</a></h1>
<p>Here are the point-source facilities emissions where amine-based CCS technology is applied. The case presented in here is over the Louisanna State. The data in the below presents the NEI2020 emissions (as “_old”) as well as modified emissions by the CCS technology (without “_old”) for major air pollutants.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

<span class="c1"># read base and sens emission scenarios</span>
<span class="n">gdf_CS_emis</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;/Users/yunhalee/Documents/LOCAETA/CS_emissions/new_NEI_point_oilgas_ptegu_ptnonimps_CCS.shp&#39;</span><span class="p">)</span>

<span class="c1"># Reset index to ensure proper comparison</span>
<span class="n">gdf_CS_emis</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># def subset_data(final_df, state_fips=None):</span>
<span class="c1">#     if state_fips:</span>
<span class="c1">#         # Match the first two digits of FIPS with State FIPS code</span>
<span class="c1">#         return final_df[final_df[&#39;FIPS&#39;].astype(str).str[:2] == str(state_fips)]</span>
<span class="c1">#     return final_df</span>

<span class="c1"># # Dictionary to loop over</span>
<span class="c1"># regions = {&quot;LA&quot;: &#39;22&#39;} #, &quot;Nation&quot;: None}</span>

<span class="c1"># final_df = gpd.GeoDataFrame(gdf_CS_emis, geometry= &quot;geometry&quot;)</span>
<span class="c1"># type(final_df)</span>

<span class="c1"># for region_name, state_fips in regions.items():</span>
    
<span class="c1">#     # Subset the DataFrame based on the chosen state or national</span>
<span class="c1">#     final_df_subset = subset_data(final_df, state_fips)</span>

<span class="c1">#     print(f&quot;Processing data for: {region_name}&quot;)</span>
    
<span class="k">def</span> <span class="nf">subset_pollutants_with_difference</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">pollutants</span><span class="p">):</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Initialize a mask to filter rows</span>
    <span class="k">for</span> <span class="n">pollutant</span> <span class="ow">in</span> <span class="n">pollutants</span><span class="p">:</span>
        <span class="n">col_current</span> <span class="o">=</span> <span class="n">pollutant</span>
        <span class="n">col_old</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pollutant</span><span class="si">}</span><span class="s1">_old&#39;</span>
        
        <span class="k">if</span> <span class="n">col_current</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="n">col_old</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="c1"># Check where the pollutant and its &quot;_old&quot; version differ</span>
            <span class="n">mask</span> <span class="o">|=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col_current</span><span class="p">]</span> <span class="o">!=</span> <span class="n">df</span><span class="p">[</span><span class="n">col_old</span><span class="p">])</span>

    <span class="c1"># Subset the dataframe based on the mask</span>
    <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>

<span class="n">pollutants</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;VOC&#39;</span><span class="p">,</span> <span class="s1">&#39;NOx&#39;</span><span class="p">,</span> <span class="s1">&#39;NH3&#39;</span><span class="p">,</span> <span class="s1">&#39;SOx&#39;</span><span class="p">,</span> <span class="s1">&#39;PM2_5&#39;</span><span class="p">]</span>
<span class="n">subset_df</span> <span class="o">=</span> <span class="n">subset_pollutants_with_difference</span><span class="p">(</span><span class="n">gdf_CS_emis</span><span class="p">,</span> <span class="n">pollutants</span><span class="p">)</span>

<span class="n">subset_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FIPS</th>
      <th>SCC</th>
      <th>VOC_old</th>
      <th>NOx_old</th>
      <th>NH3_old</th>
      <th>SOx_old</th>
      <th>PM2_5_old</th>
      <th>height</th>
      <th>diam</th>
      <th>temp</th>
      <th>velocity</th>
      <th>EIS_ID</th>
      <th>VOC</th>
      <th>NOx</th>
      <th>NH3</th>
      <th>SOx</th>
      <th>PM2_5</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>536</th>
      <td>22033</td>
      <td>10100501</td>
      <td>0.00000</td>
      <td>0.00</td>
      <td>5.0160</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>45.8724</td>
      <td>3.3528</td>
      <td>155.55556</td>
      <td>12.92352</td>
      <td>5160611</td>
      <td>1.357207</td>
      <td>0.000000</td>
      <td>22.909774</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>POINT (559622.909 -1037301.654)</td>
    </tr>
    <tr>
      <th>537</th>
      <td>22033</td>
      <td>10100604</td>
      <td>21.47000</td>
      <td>348.55</td>
      <td>0.0000</td>
      <td>5.120000</td>
      <td>29.660000</td>
      <td>45.8724</td>
      <td>3.3528</td>
      <td>155.55556</td>
      <td>12.92352</td>
      <td>5160611</td>
      <td>22.515279</td>
      <td>252.823411</td>
      <td>48.581855</td>
      <td>0.053820</td>
      <td>1.689358</td>
      <td>POINT (559622.909 -1037301.654)</td>
    </tr>
    <tr>
      <th>538</th>
      <td>22033</td>
      <td>20200203</td>
      <td>12.84000</td>
      <td>882.54</td>
      <td>103.9321</td>
      <td>5.510000</td>
      <td>20.790000</td>
      <td>53.3400</td>
      <td>4.8768</td>
      <td>172.22222</td>
      <td>25.81656</td>
      <td>5160611</td>
      <td>13.465123</td>
      <td>640.157145</td>
      <td>474.693163</td>
      <td>0.057919</td>
      <td>1.184146</td>
      <td>POINT (559553.202 -1037358.769)</td>
    </tr>
    <tr>
      <th>539</th>
      <td>22033</td>
      <td>20300203</td>
      <td>18.94000</td>
      <td>361.80</td>
      <td>0.0000</td>
      <td>8.520000</td>
      <td>59.520000</td>
      <td>53.3400</td>
      <td>4.8768</td>
      <td>111.11111</td>
      <td>23.89632</td>
      <td>5160611</td>
      <td>19.862105</td>
      <td>262.434400</td>
      <td>48.581855</td>
      <td>0.089559</td>
      <td>3.390108</td>
      <td>POINT (559506.192 -1037318.091)</td>
    </tr>
    <tr>
      <th>545</th>
      <td>22109</td>
      <td>10100601</td>
      <td>0.99805</td>
      <td>28.80</td>
      <td>0.5246</td>
      <td>0.108878</td>
      <td>1.379123</td>
      <td>18.8976</td>
      <td>2.1336</td>
      <td>194.44444</td>
      <td>18.89760</td>
      <td>5192511</td>
      <td>1.010126</td>
      <td>20.880000</td>
      <td>3.298766</td>
      <td>0.001089</td>
      <td>0.735010</td>
      <td>POINT (611355.313 -1135805.652)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The cobenefits code, which process the air quality emissions based on the CCS technology, generates higher emissions of NOx and SOx for 1-2 facilities, which appears bug in the code. The dataframe below shows two facilities with higher SOx emission by CCS.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find the case where SOx is higher than SOx_old</span>
<span class="k">if</span> <span class="s1">&#39;SOx&#39;</span> <span class="ow">in</span> <span class="n">subset_df</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="s1">&#39;SOx_old&#39;</span> <span class="ow">in</span> <span class="n">subset_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">filtered_SOx_df</span> <span class="o">=</span> <span class="n">subset_df</span><span class="p">[</span><span class="n">subset_df</span><span class="p">[</span><span class="s1">&#39;SOx&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">subset_df</span><span class="p">[</span><span class="s1">&#39;SOx_old&#39;</span><span class="p">]]</span>

<span class="n">filtered_SOx_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FIPS</th>
      <th>SCC</th>
      <th>VOC_old</th>
      <th>NOx_old</th>
      <th>NH3_old</th>
      <th>SOx_old</th>
      <th>PM2_5_old</th>
      <th>height</th>
      <th>diam</th>
      <th>temp</th>
      <th>velocity</th>
      <th>EIS_ID</th>
      <th>VOC</th>
      <th>NOx</th>
      <th>NH3</th>
      <th>SOx</th>
      <th>PM2_5</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>13980</th>
      <td>22119</td>
      <td>10200603</td>
      <td>7.970000</td>
      <td>7.950000</td>
      <td>0.0</td>
      <td>19.390000</td>
      <td>0.220000</td>
      <td>3.048</td>
      <td>0.15240</td>
      <td>277.77778</td>
      <td>12.19200</td>
      <td>8019911</td>
      <td>7.980835</td>
      <td>5.908253</td>
      <td>0.945890</td>
      <td>21.370000</td>
      <td>0.210485</td>
      <td>POINT (339024.343 -792524.971)</td>
    </tr>
    <tr>
      <th>278852</th>
      <td>22019</td>
      <td>30190014</td>
      <td>1.190847</td>
      <td>13.600003</td>
      <td>0.0</td>
      <td>0.048344</td>
      <td>0.779488</td>
      <td>15.240</td>
      <td>1.34417</td>
      <td>277.77778</td>
      <td>15.03609</td>
      <td>17905711</td>
      <td>1.196321</td>
      <td>14.150003</td>
      <td>1.605996</td>
      <td>2.028344</td>
      <td>0.718776</td>
      <td>POINT (357257.004 -1078303.820)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The dataframe below shows the facility with higher NOx emission by CCS. The incorrect emissions are very small (total 0.5 tons for NOx and 4 tons for SOx), and it is unlikely affect our overall results. Nevertheless, these emissions should be fixed from the cobenefits code in future. Otherwise, I need to manually remove these emissions.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find the case where NOx is higher than NOx_old</span>
<span class="k">if</span> <span class="s1">&#39;NOx&#39;</span> <span class="ow">in</span> <span class="n">subset_df</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="s1">&#39;NOx_old&#39;</span> <span class="ow">in</span> <span class="n">subset_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">filtered_NOx_df</span> <span class="o">=</span> <span class="n">subset_df</span><span class="p">[</span><span class="n">subset_df</span><span class="p">[</span><span class="s1">&#39;NOx&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">subset_df</span><span class="p">[</span><span class="s1">&#39;NOx_old&#39;</span><span class="p">]]</span>

<span class="n">filtered_NOx_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FIPS</th>
      <th>SCC</th>
      <th>VOC_old</th>
      <th>NOx_old</th>
      <th>NH3_old</th>
      <th>SOx_old</th>
      <th>PM2_5_old</th>
      <th>height</th>
      <th>diam</th>
      <th>temp</th>
      <th>velocity</th>
      <th>EIS_ID</th>
      <th>VOC</th>
      <th>NOx</th>
      <th>NH3</th>
      <th>SOx</th>
      <th>PM2_5</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>278852</th>
      <td>22019</td>
      <td>30190014</td>
      <td>1.190847</td>
      <td>13.600003</td>
      <td>0.0</td>
      <td>0.048344</td>
      <td>0.779488</td>
      <td>15.24</td>
      <td>1.34417</td>
      <td>277.77778</td>
      <td>15.03609</td>
      <td>17905711</td>
      <td>1.196321</td>
      <td>14.150003</td>
      <td>1.605996</td>
      <td>2.028344</td>
      <td>0.718776</td>
      <td>POINT (357257.004 -1078303.820)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">contextily</span> <span class="k">as</span> <span class="nn">ctx</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">mcolors</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Function to plot the percent change of each pollutant and its &quot;_old&quot; version with a basemap</span>
<span class="k">def</span> <span class="nf">plot_spatial_distribution_percent_change_with_basemap</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">):</span>
    <span class="n">pollutants</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;VOC&#39;</span><span class="p">,</span> <span class="s1">&#39;NOx&#39;</span><span class="p">,</span> <span class="s1">&#39;NH3&#39;</span><span class="p">,</span> <span class="s1">&#39;SOx&#39;</span><span class="p">,</span> <span class="s1">&#39;PM2_5&#39;</span><span class="p">]</span>
    
    <span class="c1"># Ensure the GeoDataFrame is in the correct CRS for basemaps (Web Mercator)</span>
    <span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="mi">3857</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">pollutant</span> <span class="ow">in</span> <span class="n">pollutants</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

        <span class="n">col_current</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pollutant</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="n">col_old</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pollutant</span><span class="si">}</span><span class="s1">_old&#39;</span>

        <span class="c1"># Ensure both the current and &quot;_old&quot; columns exist in the GeoDataFrame</span>
        <span class="k">if</span> <span class="n">col_current</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">gdf</span><span class="o">.</span><span class="n">columns</span> <span class="ow">or</span> <span class="n">col_old</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">gdf</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Columns </span><span class="si">{</span><span class="n">col_current</span><span class="si">}</span><span class="s1"> or </span><span class="si">{</span><span class="n">col_old</span><span class="si">}</span><span class="s1"> do not exist in the data.&#39;</span><span class="p">)</span>
            <span class="k">continue</span>
        
        <span class="c1"># Calculate the percent change, avoiding division by zero</span>
        <span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;percent_change&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">gdf</span><span class="p">[</span><span class="n">col_current</span><span class="p">]</span> <span class="o">-</span> <span class="n">gdf</span><span class="p">[</span><span class="n">col_old</span><span class="p">])</span> <span class="o">/</span> <span class="n">gdf</span><span class="p">[</span><span class="n">col_old</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">)))</span> <span class="o">*</span> <span class="mi">100</span>

        <span class="c1"># Plot the spatial distribution of the percent change</span>
        <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span>  <span class="c1"># Fixed color scale from -50% to 50%</span>

        <span class="k">if</span> <span class="n">pollutant</span> <span class="o">==</span> <span class="s1">&#39;NH3&#39;</span><span class="p">:</span>
            <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="o">-</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span> 

        <span class="n">gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;percent_change&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> 
                 <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>  <span class="c1"># Increase marker size and reduce transparency</span>

        <span class="c1"># Add a basemap (using OpenStreetMap)</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">ctx</span><span class="o">.</span><span class="n">providers</span><span class="o">.</span><span class="n">OpenStreetMap</span><span class="o">.</span><span class="n">Mapnik</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Percent Change in </span><span class="si">{</span><span class="n">pollutant</span><span class="si">}</span><span class="s1"> emissions by amine-based CCS&#39;</span><span class="p">)</span>

        <span class="c1"># Calculate the total, max, and min percent change</span>
        <span class="n">total_current</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="n">col_current</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">total_old</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="n">col_old</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">total_percent_change</span> <span class="o">=</span> <span class="p">((</span><span class="n">total_current</span> <span class="o">-</span> <span class="n">total_old</span><span class="p">)</span> <span class="o">/</span> <span class="n">total_old</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="n">max_percent_change</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;percent_change&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">min_percent_change</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;percent_change&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

        <span class="c1"># Display the total, max, and min percent changes on the plot</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Total Percent Change: </span><span class="si">{</span><span class="n">total_percent_change</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%</span><span class="se">\n</span><span class="s1">Max Percent Change: </span><span class="si">{</span><span class="n">max_percent_change</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%</span><span class="se">\n</span><span class="s1">Min Percent Change: </span><span class="si">{</span><span class="n">min_percent_change</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">,</span> 
                <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

        <span class="c1"># Add a color bar for the pollutant</span>
        <span class="n">sm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">mcolors</span><span class="o">.</span><span class="n">TwoSlopeNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vcenter</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">))</span>
        <span class="n">sm</span><span class="o">.</span><span class="n">_A</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.92</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">])</span>  <span class="c1"># Position color bar to avoid overlap</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">)</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pollutant</span><span class="si">}</span><span class="s1"> Percent Change&#39;</span><span class="p">)</span>

        <span class="c1"># Adjust layout to prevent overlap</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

        <span class="c1"># Save the figure for each pollutant as a separate file</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pollutant</span><span class="si">}</span><span class="s1">_percent_change_with_basemap.png&#39;</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>  <span class="c1"># Close the figure to avoid overlapping plots</span>

<span class="c1"># Example usage</span>
<span class="n">output_dir</span> <span class="o">=</span> <span class="s1">&#39;/Users/yunhalee/Documents/LOCAETA/LOCAETA_AQ/outputs/emissions/&#39;</span>
<span class="n">plot_spatial_distribution_percent_change_with_basemap</span><span class="p">(</span><span class="n">subset_df</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">AttributeError</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="nn">File ~/micromamba/lib/python3.10/site-packages/PIL/ImageFile.py:536,</span> in <span class="ni">_save</span><span class="nt">(im, fp, tile, bufsize)</span>
<span class="g g-Whitespace">    </span><span class="mi">535</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">536</span>     <span class="n">fh</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">fileno</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">537</span>     <span class="n">fp</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

<span class="ne">AttributeError</span>: &#39;_idat&#39; object has no attribute &#39;fileno&#39;

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">line</span> <span class="mi">67</span>
<span class="g g-Whitespace">     </span><span class="mi">65</span> <span class="c1"># Example usage</span>
<span class="g g-Whitespace">     </span><span class="mi">66</span> <span class="n">output_dir</span> <span class="o">=</span> <span class="s1">&#39;/Users/yunhalee/Documents/LOCAETA/LOCAETA_AQ/outputs/emissions/&#39;</span>
<span class="ne">---&gt; </span><span class="mi">67</span> <span class="n">plot_spatial_distribution_percent_change_with_basemap</span><span class="p">(</span><span class="n">subset_df</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">)</span>

<span class="nn">Cell In[4], line 62,</span> in <span class="ni">plot_spatial_distribution_percent_change_with_basemap</span><span class="nt">(gdf, output_dir)</span>
<span class="g g-Whitespace">     </span><span class="mi">59</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">61</span> <span class="c1"># Save the figure for each pollutant as a separate file</span>
<span class="ne">---&gt; </span><span class="mi">62</span> <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pollutant</span><span class="si">}</span><span class="s1">_percent_change_with_basemap.png&#39;</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">63</span> <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="nn">File ~/micromamba/lib/python3.10/site-packages/matplotlib/pyplot.py:1134,</span> in <span class="ni">savefig</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1131</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">gcf</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1132</span> <span class="c1"># savefig default implementation has no return, so mypy is unhappy</span>
<span class="g g-Whitespace">   </span><span class="mi">1133</span> <span class="c1"># presumably this is here because subclasses can return?</span>
<span class="ne">-&gt; </span><span class="mi">1134</span> <span class="n">res</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># type: ignore[func-returns-value]</span>
<span class="g g-Whitespace">   </span><span class="mi">1135</span> <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>  <span class="c1"># Need this if &#39;transparent=True&#39;, to reset colors.</span>
<span class="g g-Whitespace">   </span><span class="mi">1136</span> <span class="k">return</span> <span class="n">res</span>

<span class="nn">File ~/micromamba/lib/python3.10/site-packages/matplotlib/figure.py:3390,</span> in <span class="ni">Figure.savefig</span><span class="nt">(self, fname, transparent, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">3388</span>     <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">3389</span>         <span class="n">_recursively_make_axes_transparent</span><span class="p">(</span><span class="n">stack</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">3390</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">print_figure</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/micromamba/lib/python3.10/site-packages/matplotlib/backend_bases.py:2193,</span> in <span class="ni">FigureCanvasBase.print_figure</span><span class="nt">(self, filename, dpi, facecolor, edgecolor, orientation, format, bbox_inches, pad_inches, bbox_extra_artists, backend, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">2189</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2190</span>     <span class="c1"># _get_renderer may change the figure dpi (as vector formats</span>
<span class="g g-Whitespace">   </span><span class="mi">2191</span>     <span class="c1"># force the figure dpi to 72), so we need to set it again here.</span>
<span class="g g-Whitespace">   </span><span class="mi">2192</span>     <span class="k">with</span> <span class="n">cbook</span><span class="o">.</span><span class="n">_setattr_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">2193</span>         <span class="n">result</span> <span class="o">=</span> <span class="n">print_method</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2194</span>             <span class="n">filename</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2195</span>             <span class="n">facecolor</span><span class="o">=</span><span class="n">facecolor</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2196</span>             <span class="n">edgecolor</span><span class="o">=</span><span class="n">edgecolor</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2197</span>             <span class="n">orientation</span><span class="o">=</span><span class="n">orientation</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2198</span>             <span class="n">bbox_inches_restore</span><span class="o">=</span><span class="n">_bbox_inches_restore</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2199</span>             <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2200</span> <span class="k">finally</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2201</span>     <span class="k">if</span> <span class="n">bbox_inches</span> <span class="ow">and</span> <span class="n">restore_bbox</span><span class="p">:</span>

<span class="nn">File ~/micromamba/lib/python3.10/site-packages/matplotlib/backend_bases.py:2043,</span> in <span class="ni">FigureCanvasBase._switch_canvas_and_return_print_method.&lt;locals&gt;.&lt;lambda&gt;</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">2039</span>     <span class="n">optional_kws</span> <span class="o">=</span> <span class="p">{</span>  <span class="c1"># Passed by print_figure for other renderers.</span>
<span class="g g-Whitespace">   </span><span class="mi">2040</span>         <span class="s2">&quot;dpi&quot;</span><span class="p">,</span> <span class="s2">&quot;facecolor&quot;</span><span class="p">,</span> <span class="s2">&quot;edgecolor&quot;</span><span class="p">,</span> <span class="s2">&quot;orientation&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2041</span>         <span class="s2">&quot;bbox_inches_restore&quot;</span><span class="p">}</span>
<span class="g g-Whitespace">   </span><span class="mi">2042</span>     <span class="n">skip</span> <span class="o">=</span> <span class="n">optional_kws</span> <span class="o">-</span> <span class="p">{</span><span class="o">*</span><span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">meth</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="p">}</span>
<span class="ne">-&gt; </span><span class="mi">2043</span>     <span class="n">print_method</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">meth</span><span class="p">)(</span><span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">meth</span><span class="p">(</span>
<span class="nn">   2044         *args, **{k: v for k, v</span> in <span class="ni">kwargs.items</span><span class="nt">() if k not in skip}))</span>
<span class="g g-Whitespace">   </span><span class="mi">2045</span> <span class="k">else</span><span class="p">:</span>  <span class="c1"># Let third-parties do as they see fit.</span>
<span class="g g-Whitespace">   </span><span class="mi">2046</span>     <span class="n">print_method</span> <span class="o">=</span> <span class="n">meth</span>

<span class="nn">File ~/micromamba/lib/python3.10/site-packages/matplotlib/backends/backend_agg.py:497,</span> in <span class="ni">FigureCanvasAgg.print_png</span><span class="nt">(self, filename_or_obj, metadata, pil_kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">450</span> <span class="k">def</span> <span class="nf">print_png</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename_or_obj</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pil_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">451</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">452</span><span class="sd">     Write the figure to a PNG file.</span>
<span class="g g-Whitespace">    </span><span class="mi">453</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">495</span><span class="sd">         *metadata*, including the default &#39;Software&#39; key.</span>
<span class="g g-Whitespace">    </span><span class="mi">496</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">497</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_print_pil</span><span class="p">(</span><span class="n">filename_or_obj</span><span class="p">,</span> <span class="s2">&quot;png&quot;</span><span class="p">,</span> <span class="n">pil_kwargs</span><span class="p">,</span> <span class="n">metadata</span><span class="p">)</span>

<span class="nn">File ~/micromamba/lib/python3.10/site-packages/matplotlib/backends/backend_agg.py:446,</span> in <span class="ni">FigureCanvasAgg._print_pil</span><span class="nt">(self, filename_or_obj, fmt, pil_kwargs, metadata)</span>
<span class="g g-Whitespace">    </span><span class="mi">441</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">442</span><span class="sd"> Draw the canvas, then save it using `.image.imsave` (to which</span>
<span class="g g-Whitespace">    </span><span class="mi">443</span><span class="sd"> *pil_kwargs* and *metadata* are forwarded).</span>
<span class="g g-Whitespace">    </span><span class="mi">444</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">445</span> <span class="n">FigureCanvasAgg</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">446</span> <span class="n">mpl</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">imsave</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">447</span>     <span class="n">filename_or_obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer_rgba</span><span class="p">(),</span> <span class="nb">format</span><span class="o">=</span><span class="n">fmt</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">448</span>     <span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">dpi</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span> <span class="n">pil_kwargs</span><span class="o">=</span><span class="n">pil_kwargs</span><span class="p">)</span>

<span class="nn">File ~/micromamba/lib/python3.10/site-packages/matplotlib/image.py:1656,</span> in <span class="ni">imsave</span><span class="nt">(fname, arr, vmin, vmax, cmap, format, origin, dpi, metadata, pil_kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1654</span> <span class="n">pil_kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;format&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1655</span> <span class="n">pil_kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;dpi&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">dpi</span><span class="p">,</span> <span class="n">dpi</span><span class="p">))</span>
<span class="ne">-&gt; </span><span class="mi">1656</span> <span class="n">image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="o">**</span><span class="n">pil_kwargs</span><span class="p">)</span>

<span class="nn">File ~/micromamba/lib/python3.10/site-packages/PIL/Image.py:2459,</span> in <span class="ni">Image.save</span><span class="nt">(self, fp, format, **params)</span>
<span class="g g-Whitespace">   </span><span class="mi">2456</span>         <span class="n">fp</span> <span class="o">=</span> <span class="n">builtins</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w+b&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2458</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">2459</span>     <span class="n">save_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2460</span> <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2461</span>     <span class="k">if</span> <span class="n">open_fp</span><span class="p">:</span>

<span class="nn">File ~/micromamba/lib/python3.10/site-packages/PIL/PngImagePlugin.py:1412,</span> in <span class="ni">_save</span><span class="nt">(im, fp, filename, chunk, save_all)</span>
<span class="g g-Whitespace">   </span><span class="mi">1408</span>     <span class="n">im</span> <span class="o">=</span> <span class="n">_write_multiple_frames</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1409</span>         <span class="n">im</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">chunk</span><span class="p">,</span> <span class="n">rawmode</span><span class="p">,</span> <span class="n">default_image</span><span class="p">,</span> <span class="n">append_images</span>
<span class="g g-Whitespace">   </span><span class="mi">1410</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1411</span> <span class="k">if</span> <span class="n">im</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1412</span>     <span class="n">ImageFile</span><span class="o">.</span><span class="n">_save</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">_idat</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">chunk</span><span class="p">),</span> <span class="p">[(</span><span class="s2">&quot;zip&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">im</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">rawmode</span><span class="p">)])</span>
<span class="g g-Whitespace">   </span><span class="mi">1414</span> <span class="k">if</span> <span class="n">info</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1415</span>     <span class="k">for</span> <span class="n">info_chunk</span> <span class="ow">in</span> <span class="n">info</span><span class="o">.</span><span class="n">chunks</span><span class="p">:</span>

<span class="nn">File ~/micromamba/lib/python3.10/site-packages/PIL/ImageFile.py:540,</span> in <span class="ni">_save</span><span class="nt">(im, fp, tile, bufsize)</span>
<span class="g g-Whitespace">    </span><span class="mi">538</span>     <span class="n">_encode_tile</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">tile</span><span class="p">,</span> <span class="n">bufsize</span><span class="p">,</span> <span class="n">fh</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">539</span> <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">UnsupportedOperation</span><span class="p">)</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">540</span>     <span class="n">_encode_tile</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">tile</span><span class="p">,</span> <span class="n">bufsize</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">541</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="s2">&quot;flush&quot;</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">542</span>     <span class="n">fp</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

<span class="nn">File ~/micromamba/lib/python3.10/site-packages/PIL/ImageFile.py:559,</span> in <span class="ni">_encode_tile</span><span class="nt">(im, fp, tile, bufsize, fh, exc)</span>
<span class="g g-Whitespace">    </span><span class="mi">556</span> <span class="k">if</span> <span class="n">exc</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">557</span>     <span class="c1"># compress to Python file-compatible object</span>
<span class="g g-Whitespace">    </span><span class="mi">558</span>     <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">559</span>         <span class="n">errcode</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">bufsize</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>
<span class="g g-Whitespace">    </span><span class="mi">560</span>         <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">561</span>         <span class="k">if</span> <span class="n">errcode</span><span class="p">:</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
<img alt="_images/4d7f486bb400120db96cec8cabe59441b48faa4ea1abc9321ef7443ebdb86195.png" src="_images/4d7f486bb400120db96cec8cabe59441b48faa4ea1abc9321ef7443ebdb86195.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Function to plot the percent change of each pollutant and its &quot;_old&quot; version with a basemap</span>
<span class="k">def</span> <span class="nf">plot_spatial_distribution_relative_difference_with_basemap</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">):</span>
    <span class="n">pollutants</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;VOC&#39;</span><span class="p">,</span> <span class="s1">&#39;NOx&#39;</span><span class="p">,</span> <span class="s1">&#39;NH3&#39;</span><span class="p">,</span> <span class="s1">&#39;SOx&#39;</span><span class="p">,</span> <span class="s1">&#39;PM2_5&#39;</span><span class="p">]</span>
    
    <span class="c1"># Ensure the GeoDataFrame is in the correct CRS for basemaps (Web Mercator)</span>
    <span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="mi">3857</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">pollutant</span> <span class="ow">in</span> <span class="n">pollutants</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

        <span class="n">col_current</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pollutant</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="n">col_old</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pollutant</span><span class="si">}</span><span class="s1">_old&#39;</span>

        <span class="c1"># Ensure both the current and &quot;_old&quot; columns exist in the GeoDataFrame</span>
        <span class="k">if</span> <span class="n">col_current</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">gdf</span><span class="o">.</span><span class="n">columns</span> <span class="ow">or</span> <span class="n">col_old</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">gdf</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Columns </span><span class="si">{</span><span class="n">col_current</span><span class="si">}</span><span class="s1"> or </span><span class="si">{</span><span class="n">col_old</span><span class="si">}</span><span class="s1"> do not exist in the data.&#39;</span><span class="p">)</span>
            <span class="k">continue</span>
        
        <span class="c1"># Calculate the percent change, avoiding division by zero</span>
        <span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;reverse_percent_change&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">gdf</span><span class="p">[</span><span class="n">col_old</span><span class="p">]</span> <span class="o">-</span> <span class="n">gdf</span><span class="p">[</span><span class="n">col_current</span><span class="p">])</span> <span class="o">/</span> <span class="n">gdf</span><span class="p">[</span><span class="n">col_current</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">)))</span> <span class="o">*</span> <span class="mi">100</span>

        <span class="c1"># Plot the spatial distribution of the percent change</span>
        <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span>  <span class="c1"># Fixed color scale from -50% to 50%</span>

        <span class="k">if</span> <span class="n">pollutant</span> <span class="o">==</span> <span class="s1">&#39;NH3&#39;</span><span class="p">:</span>
            <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="o">-</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span> 

        <span class="n">gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;reverse_percent_change&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> 
                 <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>  <span class="c1"># Increase marker size and reduce transparency</span>

        <span class="c1"># Add a basemap (using OpenStreetMap)</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">ctx</span><span class="o">.</span><span class="n">providers</span><span class="o">.</span><span class="n">OpenStreetMap</span><span class="o">.</span><span class="n">Mapnik</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Relative Difference in </span><span class="si">{</span><span class="n">pollutant</span><span class="si">}</span><span class="s1"> NEI 2020 Emissions Compared to Amine-Based CCS Emissions&#39;</span><span class="p">)</span>

        <span class="c1"># Calculate the total, max, and min percent change</span>
        <span class="n">total_current</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="n">col_current</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">total_old</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="n">col_old</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">total_percent_change</span> <span class="o">=</span> <span class="p">((</span><span class="n">total_old</span> <span class="o">-</span> <span class="n">total_current</span><span class="p">)</span> <span class="o">/</span> <span class="n">total_current</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="n">max_percent_change</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;reverse_percent_change&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">min_percent_change</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;reverse_percent_change&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

        <span class="c1"># Display the total, max, and min percent changes on the plot</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Total Relative Difference: </span><span class="si">{</span><span class="n">total_percent_change</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%</span><span class="se">\n</span><span class="s1">Max Relative Difference: </span><span class="si">{</span><span class="n">max_percent_change</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%</span><span class="se">\n</span><span class="s1">Min Relative Difference: </span><span class="si">{</span><span class="n">min_percent_change</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">,</span> 
                <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

        <span class="c1"># Add a color bar for the pollutant</span>
        <span class="n">sm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">mcolors</span><span class="o">.</span><span class="n">TwoSlopeNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vcenter</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">))</span>
        <span class="n">sm</span><span class="o">.</span><span class="n">_A</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.92</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">])</span>  <span class="c1"># Position color bar to avoid overlap</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">)</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pollutant</span><span class="si">}</span><span class="s1"> Relative Difference&#39;</span><span class="p">)</span>

        <span class="c1"># Adjust layout to prevent overlap</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

        <span class="c1"># Save the figure for each pollutant as a separate file</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pollutant</span><span class="si">}</span><span class="s1">_Relative_Difference_with_basemap.png&#39;</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>  <span class="c1"># Close the figure to avoid overlapping plots</span>

<span class="c1"># Example usage</span>
<span class="n">output_dir</span> <span class="o">=</span> <span class="s1">&#39;/Users/yunhalee/Documents/LOCAETA/LOCAETA_AQ/outputs/emissions/&#39;</span>
<span class="n">plot_spatial_distribution_relative_difference_with_basemap</span><span class="p">(</span><span class="n">subset_df</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>To spatial distribution of the emissions changes by amine-based CCS technology are presented here. It shows the percent changes computed using the difference between the emissions with CCS and the original NEI2020 emissions divided by the NEI2020 emissions. For Primary PM2.5, NOx and SOx, it shows negative percent changes because the CCS tech reduces their emissions. For VOC, the percent changes are only slightly positive.</p>
<table>
  <tr>
    <td><img src="/Users/yunhalee/Documents/LOCAETA/LOCAETA_AQ/outputs/emissions/PM2_5_percent_change_with_basemap.png" alt="PM2.5" width="400"/></td>
    <td><img src="/Users/yunhalee/Documents/LOCAETA/LOCAETA_AQ/outputs/emissions/VOC_percent_change_with_basemap.png" alt="VOC" width="400"/></td>
  </tr>
  <tr>
    <td><img src="/Users/yunhalee/Documents/LOCAETA/LOCAETA_AQ/outputs/emissions/NOx_percent_change_with_basemap.png" alt="NOx" width="400"/></td>
    <td><img src="/Users/yunhalee/Documents/LOCAETA/LOCAETA_AQ/outputs/emissions/SOx_percent_change_with_basemap.png" alt="SOx" width="400"/></td>
  </tr>
</table>
<p>The amine-based CCS technology increases NH3 emissions significatly. Several point-source facilities with zero NH3 emissions in the NEI2020 emission inventory have positive NH3 emissions. Since the percent changes calculation used for other pollutants uses the NEI2020 emissions as dinominator, it drops out several facilities with zero NH3 emissions in the NEI2020 inventory. Thus, the percent change calculation used for NH3 is based on the emissions with CCS, instead of the NEI2020 emissions - it computes using the difference between the original NEI2020 emissions and the emissions with CCS, divided by the CCS emissions. The percent changes for other pollutants show how the CCS technology changes their emissions from the NEI2020 inventory while the one for NH3 shows how the NEI2020 inventory changes its emission from the CCS emissions.</p>
<td><img src="/Users/yunhalee/Documents/LOCAETA/LOCAETA_AQ/outputs/emissions/NH3_Relative_Difference_with_basemap.png" alt="NH3" width="800"/></td><p>The changes in emissions by the CCS technology is also presented in barplot. It shows total emissions in tonnes by each county (FIPS code) for each pollutant.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># sum by FIPS</span>
<span class="n">grouped_df</span> <span class="o">=</span> <span class="n">subset_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;geometry&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;FIPS&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="n">pollutants</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;VOC&#39;</span><span class="p">,</span> <span class="s1">&#39;NOx&#39;</span><span class="p">,</span> <span class="s1">&#39;NH3&#39;</span><span class="p">,</span> <span class="s1">&#39;SOx&#39;</span><span class="p">,</span> <span class="s1">&#39;PM2_5&#39;</span><span class="p">]</span>
<span class="n">pollutants_old</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pollutant</span><span class="si">}</span><span class="s1">_old&#39;</span> <span class="k">for</span> <span class="n">pollutant</span> <span class="ow">in</span> <span class="n">pollutants</span><span class="p">]</span>

<span class="c1"># Calculate total sums for each pollutant</span>
<span class="n">totals</span> <span class="o">=</span> <span class="p">{</span><span class="n">pollutant</span><span class="p">:</span> <span class="n">subset_df</span><span class="p">[</span><span class="n">pollutant</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="k">for</span> <span class="n">pollutant</span> <span class="ow">in</span> <span class="n">pollutants_old</span><span class="p">}</span>
<span class="n">totals_CCS</span> <span class="o">=</span><span class="p">{</span><span class="n">pollutant</span><span class="p">:</span> <span class="n">subset_df</span><span class="p">[</span><span class="n">pollutant</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="k">for</span> <span class="n">pollutant</span> <span class="ow">in</span> <span class="n">pollutants</span><span class="p">}</span>

<span class="c1"># Plotting</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">pollutants</span><span class="p">),</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span> <span class="p">)</span> <span class="c1">#, sharey=True)</span>
<span class="n">bar_width</span> <span class="o">=</span> <span class="mf">0.35</span>  <span class="c1"># Width of the bars</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">pollutant</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pollutants</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">grouped_df</span><span class="p">))</span>
    <span class="c1"># Plot CCS emissions</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">grouped_df</span><span class="p">[</span><span class="n">pollutant</span><span class="p">],</span> <span class="n">bar_width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pollutant</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="c1"># Plot NEI2020</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">indices</span> <span class="o">+</span> <span class="n">bar_width</span><span class="p">,</span> <span class="n">grouped_df</span><span class="p">[</span><span class="n">pollutants_old</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">bar_width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pollutants_old</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="n">total_original</span> <span class="o">=</span> <span class="n">totals</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pollutant</span><span class="si">}</span><span class="s1">_old&#39;</span><span class="p">]</span>
    <span class="n">total_new</span> <span class="o">=</span> <span class="n">totals_CCS</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pollutant</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pollutant</span><span class="si">}</span><span class="se">\n</span><span class="s1">Total: </span><span class="si">{</span><span class="n">total_original</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1"> | Change : </span><span class="si">{</span><span class="p">(</span><span class="n">total_new</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">total_original</span><span class="p">)</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1"> [tons]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;FIPS Code&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Total emissions [tons]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">indices</span> <span class="o">+</span> <span class="n">bar_width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">grouped_df</span><span class="p">[</span><span class="s1">&#39;FIPS&#39;</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;with CCS tech&quot;</span><span class="p">,</span> <span class="s2">&quot;w/o CCS tech&quot;</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/10b90d9ec847ab8fc127305f4fba88d9bb62b3f074aa6c6a556b2abde0d61e02.png" src="_images/10b90d9ec847ab8fc127305f4fba88d9bb62b3f074aa6c6a556b2abde0d61e02.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">Markdown</span>

<span class="n">markdown_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;The number of facilties applied with the amine-based CCS technology is **</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">subset_df</span><span class="p">[</span><span class="s1">&#39;EIS_ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span><span class="si">}</span><span class="s2">**, which is all located in the LA state. &quot;</span>
                 
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">pollutant</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pollutants</span><span class="p">):</span>
    <span class="n">total_original</span> <span class="o">=</span> <span class="n">totals</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pollutant</span><span class="si">}</span><span class="s1">_old&#39;</span><span class="p">]</span>
    <span class="n">change</span> <span class="o">=</span> <span class="n">totals_CCS</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pollutant</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">total_original</span>

    <span class="c1"># Use Markdown to display the computed value</span>
    <span class="n">markdown_text</span> <span class="o">+=</span><span class="sa">f</span><span class="s2">&quot;For </span><span class="si">{</span><span class="n">pollutant</span><span class="si">}</span><span class="s2">, the total NEI2020 emissions are **</span><span class="si">{</span><span class="n">total_original</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">** in tons, and it is changed by **</span><span class="si">{</span><span class="n">change</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">** with amine-based CCS technology. &quot;</span>


<span class="c1"># Display the entire paragraph in one go</span>
<span class="n">display</span><span class="p">(</span><span class="n">Markdown</span><span class="p">(</span><span class="n">markdown_text</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<p>The number of facilties applied with the amine-based CCS technology is <strong>213</strong>, which is all located in the LA state. For VOC, the total NEI2020 emissions are <strong>32984</strong> in tons, and it is changed by <strong>315</strong> with amine-based CCS technology. For NOx, the total NEI2020 emissions are <strong>97488</strong> in tons, and it is changed by <strong>-20749</strong> with amine-based CCS technology. For NH3, the total NEI2020 emissions are <strong>7397</strong> in tons, and it is changed by <strong>30585</strong> with amine-based CCS technology. For SOx, the total NEI2020 emissions are <strong>77021</strong> in tons, and it is changed by <strong>-20978</strong> with amine-based CCS technology. For PM2_5, the total NEI2020 emissions are <strong>12435</strong> in tons, and it is changed by <strong>-5921</strong> with amine-based CCS technology.</p>
</div>
</div>
<section id="inmap-simulation-results">
<h2>2. INMAP simulation results<a class="headerlink" href="#inmap-simulation-results" title="Link to this heading">#</a></h2>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Welcome to your Jupyter Book</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Assessment of Amine-based CCS in LA on air quality and public health</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ccs-faciltiy-emissions-analysis">1. CCS Faciltiy emissions analysis</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inmap-simulation-results">2. INMAP simulation results</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Yunha Lee
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>